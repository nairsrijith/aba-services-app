{% extends "base.html" %}
{% block content %}
    <div class="p-4 mb-4 rounded-3">
        {% if current_user.is_authenticated %}
            <h1>Home</h1>
            <div class="row py-2">
                {% if current_user.user_type == "admin" %}
                <div class="col-sm-4 mb-2 mb-sm-0">
                    <div class="card text-bg-dark custom-card-shadow m-2">
                        <div class="card-body">
                            <h2 class="card-title" style="text-align: center;">Employee</h2>
                            <div class="flex-container">
                                <div class="flex-item" style="font-size: 3rem; text-align: left;">
                                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e6e6ef"><path d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h168q14-36 44-58t68-22q38 0 68 22t44 58h168q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm280-670q13 0 21.5-8.5T510-820q0-13-8.5-21.5T480-850q-13 0-21.5 8.5T450-820q0 13 8.5 21.5T480-790ZM200-246q54-53 125.5-83.5T480-360q83 0 154.5 30.5T760-246v-514H200v514Zm280-194q58 0 99-41t41-99q0-58-41-99t-99-41q-58 0-99 41t-41 99q0 58 41 99t99 41ZM280-200h400v-10q-42-35-93-52.5T480-280q-56 0-107 17.5T280-210v10Zm200-320q-25 0-42.5-17.5T420-580q0-25 17.5-42.5T480-640q25 0 42.5 17.5T540-580q0 25-17.5 42.5T480-520Zm0 17Z"/></svg>
                                </div>
                                <div class="flex-item" style="font-size: 3rem; text-align: right;">{{ total_employees }}
                                    <p style="font-size: .75rem; color: #7e7e7e00;">.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-sm-4 mb-2 mb-sm-0">
                    <div class="card text-bg-dark custom-card-shadow m-2">
                        <div class="card-body">
                            <h2 class="card-title" style="text-align: center;">Client</h2>
                            <div class="flex-container">
                                <div class="flex-item" style="font-size: 3rem; text-align: left;">
                                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e6e6ef"><path d="M480-880q50 0 85 35t35 85q0 50-35 85t-85 35q-50 0-85-35t-35-85q0-50 35-85t85-35Zm0 280q47 0 93 11t83 31q38 19 61 45t23 57v232q0 17-8 33.5T710-160q-14 14-32.5 26T636-112v-90q0-38-52.5-62T480-288q-50 0-96.5 20.5T326-214q38 15 78 21t82 7h34v104q-7 2-14.5 2H490q-36 0-82.5-8T319-113q-42-17-70.5-44.5T220-224v-232q0-31 23-57t60-45q38-20 84-31t93-11Zm0 240q33 0 56.5-23.5T560-440q0-33-23.5-56.5T480-520q-33 0-56.5 23.5T400-440q0 33 23.5 56.5T480-360Z"/></svg>
                                </div>
                                <div class="flex-item" style="font-size: 3rem; text-align: right;">{{ total_clients }}
                                    <p style="font-size: .75rem; color: #7e7e7e00;">.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}
                {% if not current_user.user_type == "super" %}
                <div class="col-sm-4 mb-3 mb-sm-0">
                    <div class="card text-bg-dark custom-card-shadow m-2">
                        <div class="card-body">
                            <h2 class="card-title" style="text-align: center;">Session</h2>
                            <div class="flex-container" style="text-align: center;">
                                <div class="flex-item" style="font-size: 3rem;">
                                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M200-80q-33 0-56.5-23.5T120-160v-560q0-33 23.5-56.5T200-800h40v-80h80v80h320v-80h80v80h40q33 0 56.5 23.5T840-720v560q0 33-23.5 56.5T760-80H200Zm0-80h560v-400H200v400Zm0-480h560v-80H200v80Zm0 0v-80 80Zm280 240q-17 0-28.5-11.5T440-440q0-17 11.5-28.5T480-480q17 0 28.5 11.5T520-440q0 17-11.5 28.5T480-400Zm-160 0q-17 0-28.5-11.5T280-440q0-17 11.5-28.5T320-480q17 0 28.5 11.5T360-440q0 17-11.5 28.5T320-400Zm320 0q-17 0-28.5-11.5T600-440q0-17 11.5-28.5T640-480q17 0 28.5 11.5T680-440q0 17-11.5 28.5T640-400ZM480-240q-17 0-28.5-11.5T440-280q0-17 11.5-28.5T480-320q17 0 28.5 11.5T520-280q0 17-11.5 28.5T480-240Zm-160 0q-17 0-28.5-11.5T280-280q0-17 11.5-28.5T320-320q17 0 28.5 11.5T360-280q0 17-11.5 28.5T320-240Zm320 0q-17 0-28.5-11.5T600-280q0-17 11.5-28.5T640-320q17 0 28.5 11.5T680-280q0 17-11.5 28.5T640-240Z"/></svg>
                                </div>
                                <div class="flex-item" style="font-size: 3rem;">{{ user_interventions }}
                                    <p style="font-size: .75rem; color: #adadad;">You</p>
                                </div>
                                {% if current_user.user_type == "admin" %}
                                    <div class="flex-item" style="font-size: 3rem;">{{ total_interventions }}
                                        <p style="font-size: .75rem; color: #adadad;">Overall</p>
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}
            </div>
            {% if current_user.user_type == "admin" %}
            <div class="row px-3">
                <div class="card text-bg-dark flex-master">
                    <div class="my-3 mb-0" style="font-size: 2rem;">
                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M240-80q-50 0-85-35t-35-85v-120h120v-560l60 60 60-60 60 60 60-60 60 60 60-60 60 60 60-60 60 60 60-60v680q0 50-35 85t-85 35H240Zm480-80q17 0 28.5-11.5T760-200v-560H320v440h360v120q0 17 11.5 28.5T720-160ZM360-600v-80h240v80H360Zm0 120v-80h240v80H360Zm320-120q-17 0-28.5-11.5T640-640q0-17 11.5-28.5T680-680q17 0 28.5 11.5T720-640q0 17-11.5 28.5T680-600Zm0 120q-17 0-28.5-11.5T640-520q0-17 11.5-28.5T680-560q17 0 28.5 11.5T720-520q0 17-11.5 28.5T680-480ZM240-160h360v-80H200v40q0 17 11.5 28.5T240-160Zm-40 0v-80 80Z"/></svg>
                        Earnings
                    </div>
                    <div class="row pb-3">
                    {% for period, data in totals.items() %}
                        <div class="col-sm-4 mb-3 my-3 mb-sm-0">
                            <div class="card text-bg-dark custom-card-shadow">
                                <div class="card-body">
                                    <h2 class="card-title" style="text-align: center;">{{ period.title() }}</h2>
                                    <div class="flex-container" style="text-align: center;">
                                        <div class="flex-item" style="font-size: 1.5rem; color: rgb(0, 189, 0)">
                                            <small style="font-size: small;">CAD</small>{{ "{:15,.2f}".format(data.total_received) }}
                                            <p style="font-size: .75rem; color: #adadad;">Received</p>
                                        </div>
                                        <div class="flex-item" style="font-size: 1.5rem; color: rgb(105, 105, 255)">
                                            <small style="font-size: small;">CAD</small>{{ "{:15,.2f}".format(data.total_invoiced) }}
                                            <p style="font-size: .75rem; color: #adadad;">Total</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                    </div>
                </div>
            </div>
            {% endif %}
        {% else %}
            <div class="container-fluid py-2">
                <h2>MyApp</h2>
                <h4>A comprehensive Business Management tool for Employee management, Client relationships, Scheduling, and Invoicing</h4>
                <p>Qutie useful suite of features!</p>
                <div class="py-2">
                    <p>You need to be logged in to use this web application.</p>
                    <p>Please <a href="{{ url_for('login') }}">login</a> or <a href="{{ url_for('register') }}">register</a> to continue.</p>
                </div>
            </div>
        {% endif %}
    </div>
{% endblock %}