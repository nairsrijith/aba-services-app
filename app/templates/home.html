{% extends "base.html" %}
{% block content %}
    <style>
        .flex-master {
            box-shadow: 0 6px 10px rgba(0,0,0,.08);
        }
        .flex-container {
            display: flex;
            flex-wrap: wrap; /* Allows items to wrap to new lines */
            justify-content: space-around; /* Distributes space around items */
        }
        .custom-card-shadow {
            box-shadow: 0 6px 10px rgba(0,0,0,.08), 0 0 6px rgba(0,0,0,.05); /* Initial shadow */
            transition: transform 0.3s cubic-bezier(.155,1.105,.295,1.12), box-shadow 0.3s; /* Smooth transition */
            cursor: pointer; /* Indicate interactivity */
        }
        .custom-card-shadow:hover {
            transform: scale(1.01); /* Scale up by 1% */
            box-shadow: 0 10px 20px rgba(0,0,0,.12), 0 4px 8px rgba(0,0,0,.06); /* Enhanced shadow */
        }
    </style>
    <div class="p-4 mb-4 rounded-3">
        {% if current_user.is_authenticated %}
            <h1>Welcome to your dashboard</h1>
            <div class="row py-4">
                {% if current_user.user_type == "admin" %}
                    <div class="col-sm-4 mb-2 mb-sm-0">
                        <div class="card custom-card-shadow m-2">
                            <div class="card-body">
                                <h2 class="card-title" style="text-align: center;">Employee</h2>
                                <div class="flex-container">
                                    <div class="flex-item" style="font-size: 3rem; text-align: left;"><i class="bi-person-badge"></i></div>
                                    <div class="flex-item" style="font-size: 3rem; text-align: right;">{{ total_employees }}
                                        <p style="font-size: .75rem; color: #7e7e7e00;">.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-4 mb-2 mb-sm-0">
                        <div class="card custom-card-shadow m-2">
                            <div class="card-body">
                                <h2 class="card-title" style="text-align: center;">Client</h2>
                                <div class="flex-container">
                                    <div class="flex-item" style="font-size: 3rem; text-align: left;"><i class="bi-person-arms-up"></i></div>
                                    <div class="flex-item" style="font-size: 3rem; text-align: right;">{{ total_clients }}
                                        <p style="font-size: .75rem; color: #7e7e7e00;">.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                {% endif %}
                {% if not current_user.user_type == "super" %}
                    <div class="col-sm-4 mb-3 mb-sm-0">
                        <div class="card custom-card-shadow m-2">
                            <div class="card-body">
                                <h2 class="card-title" style="text-align: center;">Session</h2>
                                <div class="flex-container" style="text-align: center;">
                                    <div class="flex-item" style="font-size: 3rem;"><i class="bi-journal-bookmark"></i></div>
                                    <div class="flex-item" style="font-size: 3rem;">{{ user_interventions }}
                                        <p style="font-size: .75rem; color: #7e7e7e;">You</p>
                                    </div>
                                    {% if current_user.user_type == "admin" %}
                                        <div class="flex-item" style="font-size: 3rem;">{{ total_interventions }}
                                            <p style="font-size: .75rem; color: #7e7e7e;">Overall</p>
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>
                {% endif %}
            </div>
            {% if current_user.user_type == "admin" %}
                <div class="row py-4 px-3">
                    <div class="card flex-master">
                        <div class="my-3 mb-0" style="font-size: 2rem;">
                            <i class="bi-receipt"></i>
                            Earnings
                        </div>
                        <div class="row pb-3">
                        {% for period, data in totals.items() %}
                            <div class="col-sm-4 mb-3 my-3 mb-sm-0">
                                <div class="card custom-card-shadow">
                                    <div class="card-body">
                                        <h2 class="card-title" style="text-align: center;">{{ period.title() }}</h2>
                                        <div class="flex-container" style="text-align: center;">
                                            <div class="flex-item" style="font-size: 1.5rem; color: green">
                                                <small style="font-size: small;">CAD</small>{{ "{:15,.2f}".format(data.total_received) }}
                                                <p style="font-size: .75rem; color: #7e7e7e;">Received</p>
                                            </div>
                                            <div class="flex-item" style="font-size: 1.5rem; color: blue">
                                                <small style="font-size: small;">CAD</small>{{ "{:15,.2f}".format(data.total_invoiced) }}
                                                <p style="font-size: .75rem; color: #7e7e7e;">Total</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        {% endfor %}
                        </div>
                    </div>
                </div>
            {% endif %}
        {% else %}
            <div class="container-fluid py-2">
                <h2>MyApp</h2>
                <h4>A comprehensive Business Management tool for Employee management, Client relationships, Scheduling, and Invoicing</h4>
                <p>Qutie useful suite of features!</p>
                <div class="py-2">
                    <p>You need to be logged in to use this web application.</p>
                    <p>Please <a href="{{ url_for('login') }}">login</a> or <a href="{{ url_for('register') }}">register</a> to continue.</p>
                </div>
            </div>
        {% endif %}
    </div>
{% endblock %}